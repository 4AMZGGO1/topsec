

# ğŸ”§ ç½‘ç»œé…ç½®å®éªŒæŠ¥å‘Š

## âœ… ä¸€ã€å®éªŒç›®æ ‡

æ­å»ºå¦‚ä¸‹ç½‘ç»œæ‹“æ‰‘ç»“æ„ï¼Œé€šè¿‡é™æ€è·¯ç”±å®ç°ä¸åŒå­ç½‘é—´çš„äº’é€šã€‚

![image-20250805204923204](images/image-20250805204923204.png)

## ğŸŒ äºŒã€ç½‘ç»œæ‹“æ‰‘æ¦‚è§ˆ

```
                +-------------------------+
                |        Client1         |
                |     8.8.8.1/24         |
                | GW: 8.8.8.254 (R1)     |
                +-----------+------------+
                            |
                        g0/0/2
                      +--------+
                      |  R1    |
                      |        |
        +-------------+--------+--------------+
        |             |        |              |
     g0/0/0        g0/0/1   g0/0/2        (ä¸Šé¢æ¥ Client1)
   12.1.1.1       13.1.1.1   8.8.8.254
        |             |
        |             |
   +----+----+     +--+-----+
   |   R2    |     |  R3    |
   +----+----+     +--+-----+
        |             |
   +----+----+    +---+-----+
   |         |    |         |
g0/0/1   g0/0/2  g0/0/1   g0/0/2
10.1.1.254 11.1.1.254 14.1.1.254 15.1.1.254
   |         |    |         |
   |         |    |         |
+--+--+   +--+--+ +--+--+ +--+--+
| WG  |   | YF  | | CW  | |Server|
|PC   |   |PC   | |PC   | |Host  |
|10.1.1.1 |11.1.1.1|14.1.1.1|15.1.1.1|
+--------+ +------+ +------+ +--------+

```

## ğŸ“„ ä¸‰ã€IPåœ°å€ä¸è®¾å¤‡é…ç½®

### Router R1 é…ç½®

```bash
[Huawei]sysname r1
[r1]int g0/0/0
[r1-GigabitEthernet0/0/0]ip address 12.1.1.1 255.255.255.0
[r1]int g0/0/1
[r1-GigabitEthernet0/0/1]ip address 13.1.1.1 255.255.255.0
[r1]int g0/0/2
[r1-GigabitEthernet0/0/2]ip address 8.8.8.254 255.255.255.0

[r1]ip route-static 10.1.1.0 255.255.255.0 12.1.1.2
[r1]ip route-static 11.1.1.0 255.255.255.0 12.1.1.2
[r1]ip route-static 14.1.1.0 255.255.255.0 13.1.1.2
[r1]ip route-static 15.1.1.0 255.255.255.0 13.1.1.2
```

------

### Router R2 é…ç½®

```bash
[Huawei]sysname r2
[r2]int g0/0/0
[r2-GigabitEthernet0/0/0]ip address 12.1.1.2 255.255.255.0
[r2]int g0/0/1
[r2-GigabitEthernet0/0/1]ip address 10.1.1.254 255.255.255.0
[r2]int g0/0/2
[r2-GigabitEthernet0/0/2]ip address 11.1.1.254 255.255.255.0

[r2]ip route-static 0.0.0.0 0.0.0.0 12.1.1.1
```

------

### Router R3 é…ç½®

```bash
[Huawei]sysname r3
[r3]int g0/0/0
[r3-GigabitEthernet0/0/0]ip address 13.1.1.2 255.255.255.0
[r3]int g0/0/1
[r3-GigabitEthernet0/0/1]ip address 14.1.1.254 255.255.255.0
[r3]int g0/0/2
[r3-GigabitEthernet0/0/2]ip address 15.1.1.254 255.255.255.0

[r3]ip route-static 0.0.0.0 0.0.0.0 13.1.1.1
```

------

### WGä¸»æœºï¼ˆæ¨¡æ‹ŸPCï¼‰

```bash
IPåœ°å€ï¼š10.1.1.1
ç½‘å…³ï¼š10.1.1.254ï¼ˆè¿æ¥R2ï¼‰
```

------

### YFä¸»æœº

```bash
IPåœ°å€ï¼š11.1.1.1
ç½‘å…³ï¼š11.1.1.254ï¼ˆè¿æ¥R2ï¼‰
```

------

### CWä¸»æœº

```bash
IPåœ°å€ï¼š14.1.1.1
ç½‘å…³ï¼š14.1.1.254ï¼ˆè¿æ¥R3ï¼‰
```

------

### Serverä¸»æœº

```bash
IPåœ°å€ï¼š15.1.1.1
ç½‘å…³ï¼š15.1.1.254ï¼ˆè¿æ¥R3ï¼‰
```

------

### Client1ä¸»æœº

```bash
IPåœ°å€ï¼š8.8.8.1
ç½‘å…³ï¼š8.8.8.254ï¼ˆè¿æ¥R1ï¼‰
```

------

## ğŸ¯ éœ€æ±‚+ACLæ§åˆ¶ç­–ç•¥æ–¹æ¡ˆ

------

### ğŸ”’ **1. R1åªå…è®¸WGç™»å½•ï¼ŒWGèƒ½pingé€šServer1å’ŒClient1**

- **è§£é‡Š**ï¼š
  - WGçš„ `10.1.1.1` å¯ä»¥ Telnet/SSH ç™»å½• R1ï¼ˆç®¡ç†ç”¨é€”ï¼‰
  - å…¶ä»–ä»»ä½•ä¸»æœºä¸å…è®¸ç™»å½• R1
  - WG å¯ä»¥ ping é€š Client1ï¼ˆ8.8.8.1ï¼‰ å’Œ Server1ï¼ˆ15.1.1.1ï¼‰
- **è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
[r1]acl number 2000
[r1-acl-basic-2000]rule permit source 10.1.1.1 0
[r1-acl-basic-2000]rule deny


[r1]user-interface vty 0 4
[r1-ui-vty0-4]acl 2000 inbound           // è®¾ç½®åªå…è®¸ ACL 2000 ç™»å½•ï¼ˆåªå…è®¸ 10.1.1.1ï¼Œå³ WGï¼‰
[r1-ui-vty0-4]authentication-mode aaa    // è®¤è¯æ–¹å¼ä¸º AAAï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨ passwordï¼‰

[r1]aaa
[r1-aaa]local-user HCIE password cipher HUAWEI   // åˆ›å»ºç”¨æˆ·å HCIEï¼Œå¯†ç  HUAWEIï¼ˆåŠ å¯†æ–¹å¼ï¼‰
[r1-aaa]local-user HCIE service-type telnet      // è®¾ç½® HCIE ç”¨æˆ·çš„ç™»å½•æ–¹å¼ä¸º telnet

```

WGå¯ä»¥telnetç™»å½•r1

![image-20250805192737733](images/image-20250805192737733.png)

r2ä¸èƒ½telnetç™»å½•r1

![image-20250805192915895](images/image-20250805192915895.png)

WG å¯ä»¥ ping é€š Client1ï¼ˆ8.8.8.1ï¼‰ å’Œ Server1ï¼ˆ15.1.1.1ï¼‰

![image-20250805193056070](images/image-20250805193056070.png)

------

### ğŸ” **2. YF å’Œ CW ä¸èƒ½äº’é€šï¼Œä½†éƒ½èƒ½ä¸ WG é€šä¿¡**

- **è§£é‡Š**ï¼š
  - YF: `11.1.1.1`ï¼ŒCW: `14.1.1.1`ï¼ŒWG: `10.1.1.1`
  - æ‰€ä»¥è¦ï¼š
    - é˜»æ­¢ YF <--> CWï¼ˆåŒå‘ï¼‰
    - å…è®¸ YF <--> WGã€CW <--> WG
- **è§£å†³æ–¹æ¡ˆ**ï¼ˆåœ¨ R2 å’Œ R3 ä¸Šé…ç½®ï¼‰

#### åœ¨ R2 çš„ g0/0/0ï¼ˆå¯¹æ¥ R1ï¼‰å£åº”ç”¨ï¼š

```bash
[r2]acl 3001
[r2-acl-adv-3001]rule deny ip source 11.1.1.0 0.0.0.255 destination 14.1.1.0 0.0.0.255
[r2-acl-adv-3001]rule permit ip

[r2]int g0/0/0
[r2-GigabitEthernet0/0/0]traffic-filter outbound acl 3001
```

#### åœ¨ R3 çš„ g0/0/0ï¼ˆå¯¹æ¥ R1ï¼‰å£åº”ç”¨ï¼š

```bash
[r3]acl 3002
[r3-acl-adv-3002]rule deny ip source 14.1.1.0 0.0.0.255 destination 11.1.1.0 0.0.0.255
[r3-acl-adv-3002]rule permit ip

[r3]int g0/0/0
[r3-GigabitEthernet0/0/0]traffic-filter outbound acl 3002
```

#### æ€è€ƒï¼šåˆ°åº•æ˜¯æ”¾åœ¨å…¥å£ï¼ˆinboundï¼‰è¿˜æ˜¯å‡ºå£ï¼ˆoutboundï¼‰ï¼Ÿæ”¾åœ¨å“ªä¸ªæ¥å£æ›´åˆç†ï¼Ÿ



YF PING ä¸é€š CW

![image-20250805194642137](images/image-20250805194642137.png)

CW PING ä¸åŒ YF

![image-20250805194821713](images/image-20250805194821713.png)

yf ping é€š wg

![image-20250805194910375](images/image-20250805194910375.png)

CW ping é€š WG

![image-20250805194941425](images/image-20250805194941425.png)

------

### ğŸŒ **3. YYF å¯ä»¥è®¿é—® Client1ï¼ˆ8.8.8.1ï¼‰**

- **é»˜è®¤è·¯ç”±è¿é€šï¼Œä¸éœ€è¦ç‰¹åˆ«é™åˆ¶**
- **åªè¦ä¸é˜»æ–­ YF --> Client1 å³å¯**
- âœ… å·²æ»¡è¶³ï¼ˆä¸åŠ¨å³å¯ï¼‰

![image-20250805195250331](images/image-20250805195250331.png)

------

### âŒ **4. CW ä¸èƒ½è®¿é—® Client1**

- **åœ¨ R3 ä¸Šé™åˆ¶ CWï¼ˆ14.1.1.1ï¼‰è®¿é—® 8.8.8.1**

```bash
[r3]acl 3003
[r3-acl-adv-3003]rule deny ip source 14.1.1.0 0.0.0.255 destination 8.8.8.1 0
[r3-acl-adv-3003]rule permit ip


[r3]int g0/0/0
[r3-GigabitEthernet0/0/0]undo traffic-filter outbound   (åˆ é™¤ä¸Šä¸ªå®éªŒçš„ç»‘å®šACL3002,å®é™…æƒ…å†µåº”è¯¥è¿½åŠ åŠ åˆ°3002)
[r3-GigabitEthernet0/0/0]traffic-filter outbound acl 3003
```

> âš ï¸ æ³¨æ„ï¼šè¿™æ¡å¯ä»¥åˆå¹¶è¿›ä¸Šé¢çš„ 3002 ACLï¼Œä½†åˆ†å¼€æ›´æ¸…æ™°
>
> ![image-20250805200332139](images/image-20250805200332139.png)

------

### ğŸŒ **5. YF å’Œ CW åªèƒ½è®¿é—® Server1 çš„ www æœåŠ¡ï¼ˆTCP 80ç«¯å£ï¼‰**

- é™åˆ¶ï¼š
  - 11.1.1.1 --> 15.1.1.1 çš„ TCP 80 âœ…
  - 14.1.1.1 --> 15.1.1.1 çš„ TCP 80 âœ…
  - å…¶ä½™ç«¯å£ deny âŒ

#### åœ¨ R3ï¼ˆServer1 æ‰€åœ¨è·¯ç”±å™¨ï¼‰é…ç½® ACL æ§åˆ¶æœåŠ¡è®¿é—®ç«¯å£ï¼š

```bash
[r3]acl 3004
[r3-acl-adv-3004]rule permit tcp source 11.1.1.0 0.0.0.255 destination 15.1.1.1 0.0.0.0 destination-port eq 80
[r3-acl-adv-3004]rule permit tcp source 14.1.1.0 0.0.0.255 destination 15.1.1.1 0.0.0.0 destination-port eq 80
[r3-acl-adv-3004]rule deny ip 

[r3]int g0/0/2
[r3-GigabitEthernet0/0/2]traffic-filter outbound acl 3004
```

#### YFå’ŒCWå¯ä»¥è®¿é—®80ç«¯å£

![image-20250805202002694](images/image-20250805202002694.png)

YF å’Œ CW ping ä¸é€šæœåŠ¡å™¨

![image-20250805202150034](images/image-20250805202150034.png)



------

### ğŸ›¡ï¸ **6. åªæœ‰ WG æ‰èƒ½è®¿é—® Server1 æ‰€æœ‰æœåŠ¡**

- WG: 10.1.1.1
- Server1: 15.1.1.1
- å®é™…ä¸Šï¼Œ**å‰é¢çš„è§„åˆ™å·² deny å…¶ä»–äººè®¿é—® Server1 é™¤äº† TCP 80**
- åªéœ€æ˜¾å¼å…è®¸ WG å…¨éƒ¨ç«¯å£è®¿é—® Server1

#### ä¿®æ”¹ ACL 3004ï¼š   

```bash
tipsï¼šdisplay acl  ****  #æ˜¾ç¤ºå½“å‰è§„åˆ™
[r3]acl 3004
[r3-acl-adv-3004]rule 1 permit ip source 10.1.1.1 0 destination 15.1.1.1 0 #æ”¾åˆ°ç¬¬ä¸€è·³
```

WG å¯ä»¥pingé€š  server

![image-20250805202952893](images/image-20250805202952893.png)

------

## âœ… æ€»ç»“ï¼šACLä¸€è§ˆè¡¨

| è®¾å¤‡ | ACL ID | åŠŸèƒ½è¯´æ˜                              |
| ---- | ------ | ------------------------------------- |
| R1   | 3000   | åªå…è®¸WGç™»å½•VTY                       |
| R2   | 3001   | é˜»æ­¢YFè®¿é—®CW                          |
| R3   | 3002   | é˜»æ­¢CWè®¿é—®YF                          |
| R3   | 3003   | é˜»æ­¢CWè®¿é—®Client1                     |
| R3   | 3004   | æ§åˆ¶Server1æœåŠ¡ç«¯å£è®¿é—®ï¼ˆå«WGç™½åå•ï¼‰ |

------

## 

