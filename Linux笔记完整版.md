# Linux åŸºç¡€å‘½ä»¤ç¬”è®°ï¼ˆæ•´ç†ç‰ˆï¼‰

## ä¸€ã€å‘½ä»¤æç¤ºç¬¦è¯´æ˜

```bash
[root@localhost ~]#
[å½“å‰ç”¨æˆ·å@ä¸»æœºå å½“å‰æ‰€åœ¨è·¯å¾„]#
# è¡¨ç¤ºå½“å‰ç”¨æˆ·ä¸ºè¶…çº§ç”¨æˆ·ï¼ˆrootï¼‰
$ è¡¨ç¤ºå½“å‰ç”¨æˆ·ä¸ºæ™®é€šç”¨æˆ·
~ ä»£è¡¨å½“å‰ç”¨æˆ·çš„å®¶ç›®å½•
```

------

## äºŒã€ç›®å½•ç»“æ„ä¸å¸¸ç”¨å‘½ä»¤

| å‘½ä»¤                    | å«ä¹‰             |
| ----------------------- | ---------------- |
| `pwd`                   | æ˜¾ç¤ºå½“å‰ç›®å½•è·¯å¾„ |
| `ls`                    | æ˜¾ç¤ºå½“å‰ç›®å½•å†…å®¹ |
| `cd`                    | åˆ‡æ¢ç›®å½•         |
| `clear` æˆ– `Ctrl+L`     | æ¸…å±             |
| `Ctrl+-` `Ctrl+Shift++` | ç¼©æ”¾å­—ä½“         |

### Linux ä¸»è¦ç›®å½•è¯´æ˜

| ç›®å½•                 | è¯´æ˜                                          |
| -------------------- | --------------------------------------------- |
| `/`                  | æ ¹ç›®å½•ï¼Œæ‰€æœ‰ç›®å½•çš„èµ·ç‚¹                        |
| `/root`              | ç®¡ç†å‘˜çš„å®¶ç›®å½•                                |
| `/home`              | æ™®é€šç”¨æˆ·çš„å®¶ç›®å½•                              |
| `/tmp`               | ä¸´æ—¶ç›®å½•ï¼Œæ‰€æœ‰ç”¨æˆ·å¯å†™                        |
| `/dev`               | è®¾å¤‡æ–‡ä»¶                                      |
| `/etc`               | ç³»ç»Ÿé…ç½®æ–‡ä»¶ç›®å½•ï¼ˆå¦‚ `/etc/hosts`ã€DHCPé…ç½®ï¼‰ |
| `/var`               | å¯å˜æ•°æ®ç›®å½•ï¼Œå¦‚æ—¥å¿—ã€é‚®ä»¶ã€ftpç­‰             |
| `/lib` `/lib64`      | ç³»ç»Ÿåº“æ–‡ä»¶                                    |
| `/bin`               | å¸¸ç”¨äºŒè¿›åˆ¶å‘½ä»¤ï¼Œæ‰€æœ‰ç”¨æˆ·å¯æ‰§è¡Œ                |
| `/sbin`              | ç®¡ç†ç±»å‘½ä»¤ï¼Œä»… root å¯ç”¨                      |
| `/usr`               | ç”¨æˆ·å®‰è£…çš„è½¯ä»¶ç›®å½•                            |
| `/boot`              | å¯åŠ¨ç›¸å…³æ–‡ä»¶ï¼ˆå†…æ ¸ã€é©±åŠ¨ï¼‰                    |
| `/proc`              | å†…æ ¸ä¸è¿›ç¨‹è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ                        |
| `/opt`               | ç¬¬ä¸‰æ–¹è½¯ä»¶ç›®å½•                                |
| `/mnt`               | æŒ‚è½½ç‚¹                                        |
| `/media`             | ï¼ˆå·²å¼ƒç”¨ï¼‰è‡ªåŠ¨æŒ‚è½½è®¾å¤‡ç›®å½•                    |
| `/run` `/sys` `/srv` | å…¶ä»–ç³»ç»ŸæœåŠ¡ç›¸å…³ç›®å½•                          |

------

## ä¸‰ã€è·¯å¾„ä¸æ–‡ä»¶æ“ä½œ

### è·¯å¾„æ¦‚å¿µ

- **ç»å¯¹è·¯å¾„**ï¼šä»æ ¹ç›®å½• `/` å¼€å§‹çš„å®Œæ•´è·¯å¾„ï¼Œå¦‚ `/tmp/test.txt`
- **ç›¸å¯¹è·¯å¾„**ï¼šç›¸å¯¹äºå½“å‰ç›®å½•çš„è·¯å¾„ï¼Œå¦‚è¿›å…¥ `/tmp` åï¼š`cat test.txt`

### æ–‡ä»¶é¢œè‰²è¯´æ˜ï¼ˆæŒ‰ `ls` è¾“å‡ºé¢œè‰²ï¼‰

| é¢œè‰²     | ç±»å‹                       |
| -------- | -------------------------- |
| é»‘è‰²     | æ™®é€šæ–‡ä»¶ï¼ˆASCIIæ–‡æœ¬æ–‡æ¡£ï¼‰  |
| è“è‰²     | ç›®å½•                       |
| çº¢è‰²     | å‹ç¼©æ–‡ä»¶                   |
| ç»¿è‰²     | å¯æ‰§è¡Œæ–‡ä»¶                 |
| æµ…è“     | ç¬¦å·é“¾æ¥                   |
| ç´«è‰²     | å›¾ç‰‡æˆ–æ¨¡å—æ–‡ä»¶             |
| é»‘åº•é»„å­— | è®¾å¤‡æ–‡ä»¶ï¼ˆå¦‚ `/dev/null`ï¼‰ |

------

## å››ã€å®è·µç»ƒä¹ å‘½ä»¤

### ç»ƒä¹  1ï¼šåœ¨ `/tmp` ä¸­åˆ›å»ºç›®å½•å’Œæ–‡ä»¶

```bash
mkdir /tmp/topclass1
touch /tmp/topclass1/topuser.txt
echo "zyf" > /tmp/topclass1/topuser.txt
date >> /tmp/topclass1/topuser.txt
```

### åˆ é™¤æ–‡ä»¶ä¸ç›®å½•

```bash
rm -rf /tmp/topclass1
```

### ç»ƒä¹  2ï¼šå¤åˆ¶å¹¶ç§»åŠ¨ç›®å½•

```bash
# å¤åˆ¶ç›®å½•
cp -r /tmp/topclass1 /opt/

# åˆ é™¤åŸç›®å½•
rm -rf /tmp/topclass1

# ç§»åŠ¨ç›®å½•å› /tmp
mv /opt/topclass1 /tmp/
```

### ç»ƒä¹  3ï¼šåˆ›å»ºç¬¦å·é“¾æ¥ï¼ˆæ¡Œé¢å¿«æ·æ–¹å¼ï¼‰

```bash
ln -s /tmp/topclass1/topuser.txt /root/Desktop/topuser.lnk
```

> âš ï¸ é“¾æ¥æºè·¯å¾„å¿…é¡»ä½¿ç”¨**ç»å¯¹è·¯å¾„**ã€‚

------

## äº”ã€å‘½ä»¤æ ¼å¼ä¸å¸®åŠ©æ–‡æ¡£

### å‘½ä»¤æ ¼å¼ï¼š

```bash
å‘½ä»¤ [é€‰é¡¹] [æ–‡ä»¶æˆ–ç›®å½•]
```

### ä½¿ç”¨ `man` æŸ¥çœ‹å¸®åŠ©

```bash
man ls
```

### man æŸ¥çœ‹æŠ€å·§ï¼š

- `/å…³é”®å­—`ï¼šæœç´¢å…³é”®å­—
- `n`ï¼šå‘ä¸‹æŸ¥æ‰¾
- `N`ï¼šå‘ä¸ŠæŸ¥æ‰¾
- `q`ï¼šé€€å‡º

------

## å…­ã€ls å‘½ä»¤å¸¸ç”¨é€‰é¡¹

| å‘½ä»¤            | è¯´æ˜                             |
| --------------- | -------------------------------- |
| `ls -l`         | åˆ—å‡ºè¯¦ç»†ä¿¡æ¯                     |
| `ls -a`         | æ˜¾ç¤ºæ‰€æœ‰ï¼ˆåŒ…æ‹¬éšè—æ–‡ä»¶ï¼‰         |
| `ls -lh`        | äººæ€§åŒ–æ˜¾ç¤ºå¤§å°                   |
| `ls -R`         | é€’å½’æ˜¾ç¤ºå­ç›®å½•å†…å®¹               |
| `ls -ld ç›®å½•å` | æ˜¾ç¤ºç›®å½•æœ¬èº«ä¿¡æ¯ï¼ˆä¸æ˜¯å†…éƒ¨å†…å®¹ï¼‰ |

------

## ä¸ƒã€cp ä¸ rm å‘½ä»¤å‚æ•°è¯´æ˜ï¼ˆman æŸ¥è¯¢ç»“æœï¼‰

```bash
cp -r      # é€’å½’å¤åˆ¶æ•´ä¸ªç›®å½•
rm -r      # é€’å½’åˆ é™¤ç›®å½•
rm -f      # å¼ºåˆ¶åˆ é™¤ï¼ˆå¿½ç•¥ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œä¸æç¤ºï¼‰
```

------

## å…«ã€æŸ¥çœ‹æ–‡ä»¶å†…å®¹å‘½ä»¤

| å‘½ä»¤   | åŠŸèƒ½                          |
| ------ | ----------------------------- |
| `cat`  | ä¸€æ¬¡æ€§æŸ¥çœ‹æ•´ä¸ªæ–‡ä»¶            |
| `head` | æŸ¥çœ‹å‰ 10 è¡Œ                  |
| `tail` | æŸ¥çœ‹å 10 è¡Œ                  |
| `more` | åˆ†é¡µæŸ¥çœ‹                      |
| `less` | é€é¡µ/é€è¡ŒæŸ¥çœ‹ï¼ˆæ”¯æŒä¸Šä¸‹ç¿»é¡µï¼‰ |

### å®æ—¶æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶

```bash
tail -f /var/log/secure
```

------

## ä¹ã€ç½‘ç»œä¸ç«¯å£æŸ¥çœ‹

### æŸ¥çœ‹ç«¯å£ç›‘å¬çŠ¶æ€

```bash
netstat -antpl
```

- `-a`ï¼šæ˜¾ç¤ºæ‰€æœ‰è¿æ¥å’Œç›‘å¬ç«¯å£
- `-n`ï¼šæ•°å­—æ–¹å¼æ˜¾ç¤ºåœ°å€å’Œç«¯å£
- `-t`ï¼šæ˜¾ç¤º TCP åè®®è¿æ¥
- `-p`ï¼šæ˜¾ç¤ºå¯¹åº”çš„è¿›ç¨‹åç§°
- `-l`ï¼šä»…æ˜¾ç¤ºç›‘å¬çŠ¶æ€ç«¯å£

> â“è¿˜æœ‰å…¶ä»–æŸ¥çœ‹ç«¯å£å‘½ä»¤å¦‚ï¼š
>  `ss -tunlp`ã€`lsof -i:ç«¯å£å·`

------

## åã€è¿œç¨‹ç™»å½•ä¸æ—¥å¿—æŸ¥çœ‹

### ä½¿ç”¨ SSH ç™»å½• Linux

```bash
ssh root@192.168.133.131
```

### åˆ‡æ¢ç”¨æˆ·ä¸é€€å‡º

```bash
su - allen   # åˆ‡æ¢ä¸º allen ç”¨æˆ·
exit         # é€€å‡ºå½“å‰ shell
```

### ç™»å½•å¤±è´¥æŸ¥çœ‹æ—¥å¿—

```bash
tail -f /var/log/secure
```

> ç™»å½•å¤±è´¥ã€ç”¨æˆ·åˆ‡æ¢ç­‰ä¿¡æ¯éƒ½è®°å½•åœ¨è¯¥æ—¥å¿—æ–‡ä»¶ä¸­ã€‚

------

ä»¥ä¸‹æ˜¯ä½ æä¾›å†…å®¹çš„æ•´ç†ä¸è¡¥å……ï¼Œé‡‡ç”¨äº†æ¸…æ™°çš„ç»“æ„ä¸ Markdown æ ¼å¼ï¼Œæ–¹ä¾¿æŸ¥é˜…å’Œç»§ç»­å­¦ä¹ ã€‚å†…å®¹æ¶‰åŠæ—¥æœŸå‘½ä»¤ã€ç›®å½•åˆ›å»ºã€é“¾æ¥ç±»å‹ã€æ–‡ä»¶å†…å®¹æŸ¥çœ‹ã€ç»Ÿè®¡ä¸è¿‡æ»¤ã€æŸ¥æ‰¾å‘½ä»¤ç­‰å®ç”¨æ“ä½œã€‚

------

# Linux å¸¸ç”¨å‘½ä»¤ä¸æŠ€å·§ï¼ˆäºŒï¼‰

## ä¸€ã€æ—¥æœŸä¸æ—¶é—´æ ¼å¼åŒ–

```bash
date +%F
```

- è¾“å‡ºæ ¼å¼ï¼š`YYYY-MM-DD`
- `man date` å¯æŸ¥çœ‹æ›´å¤šæ ¼å¼åŒ–é€‰é¡¹ï¼Œå¦‚ï¼š
  - `%F`ï¼šå®Œæ•´æ—¥æœŸï¼ˆç­‰åŒäº `%Y-%m-%d`ï¼‰
  - `%T`ï¼šæ—¶é—´ï¼ˆç­‰åŒäº `%H:%M:%S`ï¼‰

------

## äºŒã€ç›®å½•åˆ›å»º

```bash
mkdir -p /path/to/dir
```

- `-p`ï¼šåˆ›å»ºå¤šçº§ç›®å½•æ—¶ä¸ä¼šæŠ¥é”™ï¼Œå³ä½¿ä¸­é—´ç›®å½•ä¸å­˜åœ¨ä¹Ÿä¼šè‡ªåŠ¨åˆ›å»ºã€‚
- å¦‚æœç›®å½•å·²å­˜åœ¨ï¼Œä¸ä¼šæŠ¥é”™ã€‚

------

## ä¸‰ã€é“¾æ¥ï¼ˆLinkï¼‰

### 1. ç¡¬é“¾æ¥ï¼ˆHard Linkï¼‰

```bash
ln åŸæ–‡ä»¶ ç¡¬é“¾æ¥è·¯å¾„
```

- åªèƒ½å¯¹**æ–‡ä»¶**åˆ›å»ºã€‚
- ä¸æºæ–‡ä»¶å…±äº« inodeï¼ˆæœ¬è´¨ä¸Šæ˜¯â€œåŒä¸€ä¸ªæ–‡ä»¶â€ï¼‰ã€‚
- **åˆ é™¤åŸæ–‡ä»¶ä¸å½±å“ç¡¬é“¾æ¥çš„ä½¿ç”¨**ã€‚
- ä¸å¯å¯¹ç›®å½•å»ºç«‹ç¡¬é“¾æ¥ï¼ˆé™¤éä½¿ç”¨ç‰¹æ®Šæƒé™ï¼‰ã€‚

### 2. ç¬¦å·é“¾æ¥ï¼ˆè½¯é“¾æ¥ Symbolic Linkï¼‰

```bash
ln -s åŸè·¯å¾„ é“¾æ¥è·¯å¾„
```

- å¯é“¾æ¥æ–‡ä»¶æˆ–ç›®å½•ã€‚
- ç±»ä¼¼ Windows å¿«æ·æ–¹å¼ï¼Œä¿å­˜çš„æ˜¯è·¯å¾„ã€‚
- **æºæ–‡ä»¶åˆ é™¤ï¼Œé“¾æ¥å¤±æ•ˆï¼ˆå˜ä¸ºâ€œæ­»é“¾æ¥â€ï¼‰**ã€‚

------

## å››ã€æŸ¥çœ‹æ–‡ä»¶å†…å®¹

| å‘½ä»¤        | ç”¨é€”                    |
| ----------- | ----------------------- |
| `cat`       | æ˜¾ç¤ºæ•´ä¸ªæ–‡ä»¶å†…å®¹        |
| `cat -n`    | å¸¦è¡Œå·æ˜¾ç¤º              |
| `head -n 6` | æ˜¾ç¤ºå‰6è¡Œ               |
| `tail -n 6` | æ˜¾ç¤ºå6è¡Œ               |
| `more`      | åˆ†é¡µæ˜¾ç¤ºï¼ˆç©ºæ ¼ç¿»é¡µï¼‰    |
| `less`      | å¯ä¸Šä¸‹æ»šåŠ¨æŸ¥çœ‹ï¼ˆqé€€å‡ºï¼‰ |

------

## äº”ã€ç£ç›˜ä¸ç©ºé—´å ç”¨

### æŸ¥çœ‹ç£ç›˜åˆ†åŒºä¸ä½¿ç”¨æƒ…å†µ

```bash
df -Th
```

- `-T` æ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿç±»å‹
- `-h` äººç±»å¯è¯»å•ä½ï¼ˆKB/MB/GBï¼‰

### æŸ¥çœ‹ç›®å½•å¤§å°ï¼ˆå½“å‰ç›®å½•ä¸‹ï¼‰

```bash
du -sh *
```

- `-s` æ±‡æ€»æ¯ä¸ªå­ç›®å½•æ€»å¤§å°
- `-h` äººç±»å¯è¯»å•ä½

------

## å…­ã€æ–‡ä»¶ç»Ÿè®¡å‘½ä»¤

### ç»Ÿè®¡æ–‡ä»¶åŸºæœ¬ä¿¡æ¯

```bash
wc /etc/passwd
```

è¾“å‡ºç¤ºä¾‹ï¼š`43 86 2240 /etc/passwd`
 åˆ†åˆ«è¡¨ç¤ºï¼š**è¡Œæ•°ã€å•è¯æ•°ã€å­—ç¬¦æ•°**

### åªæŸ¥çœ‹è¡Œæ•°

```bash
wc -l /etc/passwd
```

------

## ä¸ƒã€æ–‡æœ¬æœç´¢ä¸è¿‡æ»¤ï¼ˆgrepï¼‰

### åŸºæœ¬ç”¨æ³•

```bash
grep "å…³é”®å­—" æ–‡ä»¶
```

### å¸¸è§é€‰é¡¹

| å‘½ä»¤      | è¯´æ˜               |
| --------- | ------------------ |
| `-n`      | æ˜¾ç¤ºåŒ¹é…çš„è¡Œå·     |
| `^å­—ç¬¦ä¸²` | åŒ¹é…ä»¥è¯¥å­—ç¬¦ä¸²å¼€å¤´ |
| `å­—ç¬¦ä¸²$` | åŒ¹é…ä»¥è¯¥å­—ç¬¦ä¸²ç»“å°¾ |
| `-v`      | åå‘åŒ¹é…ï¼ˆä¸åŒ…å«ï¼‰ |
| `-i`      | å¿½ç•¥å¤§å°å†™         |

### å®ä¾‹

- åˆ¤æ–­æ˜¯å¦å­˜åœ¨ root ç”¨æˆ·ï¼š

```bash
grep "^root" /etc/passwd
```

- æŸ¥çœ‹å¯ç™»å½•è´¦æˆ·ï¼ˆé»˜è®¤ shell ä¸º bashï¼‰ï¼š

```bash
grep "bash$" /etc/passwd
```

- æŸ¥çœ‹**ä¸å¯ç™»å½•**è´¦æˆ·ï¼š

```bash
grep -v "bash$" /etc/passwd
```

------

## å…«ã€æ—¥å¿—æ”»å‡»ä¿¡æ¯è¿‡æ»¤ç»ƒä¹ ï¼ˆé‡ç‚¹ï¼‰

### 1. æŸ¥çœ‹æ‰€æœ‰ Failed ç™»å½•è®°å½•

```bash
grep "Failed password" /var/log/secure
```

### 2. æ˜¾ç¤ºè¡Œå·

```bash
grep -n "Failed password" /var/log/secure
```

### 3. æŸ¥çœ‹è®°å½•æ•°é‡

```bash
grep "Failed password" /var/log/secure | wc -l
```

### 4. æå–æ”»å‡»æ¥æº IPï¼ˆå‡è®¾ç¬¬11å­—æ®µä¸º IPï¼‰

```bash
grep "Failed password" /var/log/secure | awk '{print $11}'
```

### 5. æ’åºå¹¶å»é‡

```bash
grep "Failed password" /var/log/secure | awk '{print $11}' | sort | uniq
```

### 6. ç»Ÿè®¡æ¯ä¸ª IP æ”»å‡»æ¬¡æ•°

```bash
grep "Failed password" /var/log/secure | awk '{print $11}' | sort | uniq -c
```

------

## ä¹ã€find æŸ¥æ‰¾å‘½ä»¤ï¼ˆé‡ç‚¹ï¼‰

> ä¸ `grep` é’ˆå¯¹æ–‡ä»¶å†…å®¹ä¸åŒï¼Œ`find` æ˜¯æŸ¥æ‰¾æ–‡ä»¶æˆ–ç›®å½•æœ¬èº«ã€‚

### åŸºæœ¬è¯­æ³•

```bash
find [æŸ¥æ‰¾è·¯å¾„] [åŒ¹é…æ¡ä»¶]
```

### ç¤ºä¾‹

#### 1. æŸ¥æ‰¾ç³»ç»Ÿä¸­åŒ…å« `passwd` çš„æ–‡ä»¶æˆ–ç›®å½•

```bash
find / -name "*passwd*"
```

#### 2. æŸ¥æ‰¾ `/etc` ç›®å½•ä¸‹æ‰©å±•åä¸º `.conf` çš„æ–‡ä»¶

```bash
find /etc -name "*.conf"
```

#### 3. æŸ¥æ‰¾å¤§å°å¤§äº 100M çš„æ–‡ä»¶

```bash
find / -type f -size +100M
```

#### 4. æŸ¥æ‰¾æœ€è¿‘7å¤©å†…ä¿®æ”¹çš„æ–‡ä»¶

```bash
find / -type f -mtime -7
```

------

## åã€å…¶ä»–å‘½ä»¤å»ºè®®

| å‘½ä»¤              | ç”¨é€”                            |
| ----------------- | ------------------------------- |
| `ss -tunlp`       | æ›´å¿«æ›¿ä»£ `netstat` æŸ¥çœ‹ç«¯å£å ç”¨ |
| `lsof -i :ç«¯å£å·` | æŸ¥çœ‹æŒ‡å®šç«¯å£è¢«å“ªä¸ªè¿›ç¨‹å ç”¨      |
| `history`         | æŸ¥çœ‹å‘½ä»¤å†å²                    |
| `who` / `w`       | æŸ¥çœ‹å½“å‰åœ¨çº¿ç”¨æˆ·                |

------

ä½ è¿™æ®µå†…å®¹å¾ˆå®ç”¨ï¼Œä»¥ä¸‹æ˜¯æˆ‘æ ¹æ®ä½ çš„ç¬”è®°å†…å®¹æ•´ç†å’Œè¡¥å……çš„ **`find` å‘½ä»¤è®²è§£**ï¼ŒåŒ…æ‹¬ `-exec` çš„ä½¿ç”¨ã€é€»è¾‘è¿ç®—ç¬¦ï¼ˆå¦‚ `-a`ã€`-o`ï¼‰ã€ä»¥åŠå¦‚ä½•æ›¿ä»£ç®¡é“ç­‰ã€‚å·²æ•´ç†ä¸º Markdown ç»“æ„ï¼Œä¾¿äºå¤ä¹ ä½¿ç”¨ã€‚

------



# Linux `find` å‘½ä»¤è¯¦è§£ä¸å®ç”¨æŠ€å·§

## ä¸€ã€åŸºæœ¬è¯­æ³•

```bash
find [æŸ¥æ‰¾è·¯å¾„] [åŒ¹é…æ¡ä»¶]
```

------

## äºŒã€å¸¸ç”¨ç¤ºä¾‹

### 1. æŸ¥æ‰¾ç³»ç»Ÿä¸­åç§°ä¸º `passwd` çš„æ–‡ä»¶æˆ–ç›®å½•

```bash
find / -name passwd
```

> æ³¨æ„ï¼šæ­¤å‘½ä»¤ä¼šåŒæ—¶æŸ¥æ‰¾**æ–‡ä»¶å’Œç›®å½•**

------

### 2. åªæŸ¥æ‰¾æ–‡ä»¶ï¼ˆfileï¼‰

```bash
find / -name passwd -a -type f
```

### 3. åªæŸ¥æ‰¾ç›®å½•ï¼ˆdirectoryï¼‰

```bash
find / -name passwd -a -type d
```

------

## ä¸‰ã€é€»è¾‘è¿ç®—ç¬¦è¯´æ˜ï¼ˆå¯ç”¨ `man find` æŸ¥çœ‹ï¼‰

| é€»è¾‘ç¬¦ | å«ä¹‰                                      | ç¤ºä¾‹                                 |
| ------ | ----------------------------------------- | ------------------------------------ |
| `-a`   | **ä¸ï¼ˆANDï¼‰**ï¼Œä¸¤ä¸ªæ¡ä»¶éƒ½æ»¡è¶³ï¼ˆé»˜è®¤é€»è¾‘ï¼‰ | `-name xxx -a -type f`               |
| `-o`   | **æˆ–ï¼ˆORï¼‰**ï¼Œåªéœ€æ»¡è¶³ä¸€ä¸ªæ¡ä»¶            | `-name aaa -o -name bbb`             |
| `!`    | éï¼ˆNOTï¼‰                                 | `! -name passwd` è¡¨ç¤ºåç§°ä¸æ˜¯ passwd |

------

## å››ã€`-exec` è¿›è¡ŒäºŒæ¬¡å¤„ç†

`find` ä¸èƒ½ç›´æ¥é€šè¿‡ `|` ç®¡é“ä¼ é€’ç»™ `ls` æˆ–å…¶ä»–å‘½ä»¤ï¼Œä½†å¯ä»¥ä½¿ç”¨ `-exec` æ¥å®ç°ç±»ä¼¼æ•ˆæœã€‚

### æ­£ç¡®æ–¹å¼ï¼šä½¿ç”¨ `-exec`

```bash
find / -name passwd -exec ls -l '{}' \;
```

> è¯´æ˜ï¼š
>
> - `{}` è¡¨ç¤º `find` æŸ¥æ‰¾åˆ°çš„æ¯ä¸€ä¸ªæ–‡ä»¶/ç›®å½•çš„å ä½ç¬¦ï¼›
> - `\;` è¡¨ç¤ºå‘½ä»¤ç»“æŸï¼ˆå¿…é¡»æœ‰è½¬ä¹‰ç¬¦ï¼‰ï¼›
> - ç­‰æ•ˆäºå¯¹æ¯ä¸ªæŸ¥æ‰¾åˆ°çš„é¡¹æ‰§è¡Œä¸€æ¬¡ `ls -l`ã€‚

------

## äº”ã€è¡¥å……ï¼šæ‰¹é‡å¤„ç†å¤šä¸ªæ–‡ä»¶ï¼ˆ`+`ï¼‰

```bash
find / -name passwd -exec ls -l '{}' +
```

> ä¸ `\;` çš„åŒºåˆ«æ˜¯ï¼š`+` ä¼š**å°†å¤šä¸ªç»“æœä¸€æ¬¡æ€§ä¼ å…¥ `ls -l`**ï¼Œæ•ˆç‡æ›´é«˜ã€‚

------

## å…­ã€æ›´å¤šå®ç”¨ find ç¤ºä¾‹

### æŸ¥æ‰¾æŒ‡å®šç›®å½•ä¸‹æ‰€æœ‰ `.conf` é…ç½®æ–‡ä»¶

```bash
find /etc -name "*.conf"
```

### æŸ¥æ‰¾å¤§å°å¤§äº 100MB çš„æ–‡ä»¶

```bash
find / -type f -size +100M
```

### æŸ¥æ‰¾ 7 å¤©å†…ä¿®æ”¹è¿‡çš„æ–‡ä»¶

```bash
find / -type f -mtime -7
```

### æŸ¥æ‰¾å½“å‰ç”¨æˆ·æ‹¥æœ‰çš„æ–‡ä»¶

```bash
find /home -user your_username
```

------

## ä¸ƒã€å¸¸è§é—®é¢˜æ±‡æ€»

| é—®é¢˜                                      | è§£å†³æ–¹æ³•                    |
| ----------------------------------------- | --------------------------- |
| æƒ³ç”¨ `find` æŸ¥æ‰¾å `ls -l` æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼Ÿ | ç”¨ `-exec ls -l '{}' \;`    |
| æƒ³å¯¹ç»“æœç»Ÿä¸€å¤„ç†ï¼Ÿ                        | ä½¿ç”¨ `-exec` æˆ–æ­é… `xargs` |
| `                                         | ls -l` æ— æ•ˆï¼Ÿ               |
| æƒ³è¦æ›´é«˜æ•ˆå¤„ç†ï¼Ÿ                          | ç”¨ `-exec ... +` æ›¿ä»£ `\;`  |

------

ä»¥ä¸‹æ˜¯ä½ è¿™éƒ¨åˆ†å†…å®¹çš„æ•´ç†ä¸è¡¥å……ï¼Œæ¶µç›–äº† `find` æŸ¥æ‰¾ã€`dd` åˆ›å»ºå¤§æ–‡ä»¶ã€å‹ç¼©ä¸è§£å‹ã€`tar` æ‰“åŒ…å½’æ¡£ï¼Œä»¥åŠæºç å®‰è£…ä¸å°è£…è½¯ä»¶åŒ…å®‰è£…ç­‰ï¼Œå†…å®¹ç³»ç»Ÿå®Œæ•´ï¼Œé€‚åˆç”¨äºæ—¥å¸¸è¿ç»´æ“ä½œä¸å¤ä¹ ä½¿ç”¨ã€‚

------

# Linux å‘½ä»¤å®ç”¨ç¬”è®°ï¼ˆä¸‰ï¼‰

------

## ä¸€ã€æŸ¥æ‰¾å¤§æ–‡ä»¶

### 1. æŸ¥æ‰¾ `/boot` ç›®å½•ä¸­å¤§äº 3M å°äº 10M çš„æ–‡ä»¶ï¼š

```bash
find /boot -size +3M -a -size -10M
```

- `+3M`ï¼šå¤§äº 3MB
- `-10M`ï¼šå°äº 10MB
- `-a`ï¼šé€»è¾‘ä¸ï¼ˆANDï¼‰

------

## äºŒã€ä½¿ç”¨ `dd` åˆ›å»ºå¤§æ–‡ä»¶

### åˆ›å»ºä¸€ä¸ª 100MB çš„äºŒè¿›åˆ¶æ–‡ä»¶ `bigfile`ï¼Œå†…å®¹ä¸º 0ï¼š

```bash
dd if=/dev/zero of=/tmp/bigfile bs=1M count=100
```

- `if=`ï¼šè¾“å…¥æ–‡ä»¶ï¼ˆè¿™é‡Œæ˜¯ /dev/zeroï¼ŒæŒç»­è¾“å‡º 0ï¼‰
- `of=`ï¼šè¾“å‡ºæ–‡ä»¶è·¯å¾„
- `bs=1M`ï¼šæ¯æ¬¡å†™å…¥å—å¤§å°ä¸º 1MB
- `count=100`ï¼šå†™å…¥ 100 ä¸ªå—ï¼ˆæ€»å…± 100MBï¼‰

------

## ä¸‰ã€å‹ç¼©ä¸è§£å‹ç¼©ï¼ˆé’ˆå¯¹æ–‡ä»¶ï¼‰

### å‹ç¼©

```bash
gzip filename      # ç”Ÿæˆ filename.gz
bzip2 filename     # ç”Ÿæˆ filename.bz2
```

### è§£å‹ç¼©

```bash
gunzip filename.gz
bunzip2 filename.bz2
```

------

## å››ã€æ‰“åŒ…ä¸å½’æ¡£ï¼ˆtarï¼‰

### 1. æ‰“åŒ… `/tmp/topclass1` ç›®å½•ï¼Œç”Ÿæˆ `.tar` æ–‡ä»¶å¹¶æ”¾ç½®æ¡Œé¢ï¼š

```bash
tar -cf /root/Desktop/topclass1.tar /tmp/topclass1
```

- `-c`ï¼šåˆ›å»ºå½’æ¡£
- `-f`ï¼šæŒ‡å®šå½’æ¡£æ–‡ä»¶ï¼ˆå¿…é¡»ç´§è·Ÿæ–‡ä»¶åï¼‰

### 2. å¯¹æ‰“åŒ…æ–‡ä»¶è¿›è¡Œå‹ç¼©

```bash
# gzip å‹ç¼©
gzip /root/Desktop/topclass1.tar

# bzip2 å‹ç¼©
bzip2 /root/Desktop/topclass1.tar
```

> æœ€ç»ˆç”Ÿæˆ `.tar.gz` æˆ– `.tar.bz2` æ–‡ä»¶ã€‚

------

## äº”ã€è§£å‹ç¼©ä¸è§£åŒ…

### è§£å‹ `.gz` å’Œ `.bz2`

```bash
gunzip topclass1.tar.gz
bunzip2 topclass1.tar.bz2
```

### è§£åŒ… `.tar` æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•ï¼ˆä¾‹å¦‚ /optï¼‰

```bash
tar -xf /root/Desktop/topclass1.tar -C /opt
```

------

### æ‰“åŒ… + å‹ç¼© ä¸€æ­¥å®Œæˆ

| å‹ç¼©æ ¼å¼   | å‘½ä»¤ç¤ºä¾‹                                                  |
| ---------- | --------------------------------------------------------- |
| `.tar.gz`  | `tar -zcf /root/Desktop/topclass1.tar.gz /tmp/topclass1`  |
| `.tar.bz2` | `tar -jcf /root/Desktop/topclass1.tar.bz2 /tmp/topclass1` |

### è§£å‹ `.tar.gz` `.tar.bz2` åˆ°æŒ‡å®šç›®å½•

```bash
tar -zxf topclass1.tar.gz -C /opt
tar -jxf topclass1.tar.bz2 -C /opt
```

------

## å…­ã€Linux è½¯ä»¶å®‰è£…æ–¹å¼

### æ–¹å¼ä¸€ï¼š**æºç å®‰è£…**

ç‰¹ç‚¹ï¼šçµæ´»å¯æ§ï¼Œä½†å®‰è£…è¿‡ç¨‹å¤æ‚

### 1. ä¸‹è½½å¹¶è§£å‹æºç åŒ…

```bash
tar -zxf httpd-xxx.tar.gz
cd httpd-xxx
```

### 2. æŸ¥çœ‹å®‰è£…è¯´æ˜

```bash
less INSTALL
./configure --help
```

### 3. é…ç½®å®‰è£…ç›®å½•

```bash
./configure --prefix=/usr/local/webserver
```

> æ£€æŸ¥ç¯å¢ƒä¾èµ–ä¸å®‰è£…é€‰é¡¹

### 4. ç¼–è¯‘æºç 

```bash
make
```

### 5. å®‰è£…

```bash
make install
```

### 6. å¯åŠ¨ä¸å…³é—­

è§†å…·ä½“è½¯ä»¶æ–‡æ¡£è¯´æ˜ï¼Œä¸€èˆ¬åœ¨ `/usr/local/webserver/bin/` ä¸­ã€‚

------

### æ–¹å¼äºŒï¼š**å°è£…åŒ…å®‰è£…ï¼ˆæ¨èï¼‰**

#### Debian/Ubuntu ç³»ç»Ÿï¼ˆ`.deb` åŒ…ï¼‰

```bash
sudo dpkg -i linuxqq_2.0.0-b2-1089_amd64.deb
```

#### RedHat/CentOS ç³»ç»Ÿï¼ˆ`.rpm` åŒ…ï¼‰

```bash
sudo rpm -ivh package-name.rpm
```

------

## ä¸ƒã€æ€»ç»“ï¼šæºç  vs å°è£…åŒ…

| å®‰è£…æ–¹å¼   | ä¼˜ç‚¹                   | ç¼ºç‚¹                     |
| ---------- | ---------------------- | ------------------------ |
| æºç å®‰è£…   | çµæ´»ã€å¯å®šåˆ¶ã€æ›´æ–°åŠæ—¶ | æ“ä½œå¤æ‚ã€éœ€æ‰‹åŠ¨è§£å†³ä¾èµ– |
| å°è£…åŒ…å®‰è£… | å¿«é€Ÿã€ç®€å•             | ä¾èµ–é¢„è®¾ã€å¯å®šåˆ¶æ€§å·®     |

------

ä»¥ä¸‹æ˜¯ä½ è¿™éƒ¨åˆ†å…³äº **Linux è½¯ä»¶å®‰è£…ã€åŒ…ç®¡ç†ã€ç”¨æˆ·ä¸ç»„ç®¡ç†** çš„å®Œæ•´æ•´ç†å’Œè¡¥å……å†…å®¹ï¼Œé‡‡ç”¨æ¸…æ™°çš„ Markdown ç»“æ„ï¼Œä¾¿äºç³»ç»Ÿå­¦ä¹ å’Œå¤ä¹ ã€‚

------

# Linux ç³»ç»Ÿç®¡ç†ç¬”è®°ï¼ˆå››ï¼‰

------

## ä¸€ã€RPM åŒ…ç®¡ç†

### 1. æŸ¥çœ‹æ˜¯å¦å®‰è£…è¿‡æŸä¸ªè½¯ä»¶åŒ…

```bash
rpm -qa | grep vim           # æ£€æŸ¥æ˜¯å¦å®‰è£… vim
rpm -qa | wc -l              # æŸ¥çœ‹å·²å®‰è£…åŒ…çš„æ€»æ•°é‡
ls | wc -l                   # å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶æ•°
```

------

### 2. æŸ¥çœ‹è½¯ä»¶åŒ…è¯´æ˜

```bash
rpm -qpi lftp-4.4.8-8.el7_3.2.x86_64.rpm
```

------

### 3. æŸ¥çœ‹è½¯ä»¶åŒ…å®‰è£…åæ–‡ä»¶è·¯å¾„

```bash
rpm -qpl lftp-4.4.8-8.el7_3.2.x86_64.rpm
```

------

### 4. å®‰è£… RPM åŒ…

```bash
rpm -ivh lftp-4.4.8-8.el7_3.2.x86_64.rpm
```

- `-i`ï¼šå®‰è£…
- `-v`ï¼šæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
- `-h`ï¼šæ˜¾ç¤ºå®‰è£…è¿›åº¦æ¡ï¼ˆ#ï¼‰

------

### 5. ç¼–ç ä¹±ç é—®é¢˜ï¼ˆå¦‚ lftp ä¸­æ–‡ä¹±ç ï¼‰

- ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š

```bash
vi /etc/lftp.conf
```

- æ·»åŠ å†…å®¹ï¼š

```conf
set charset utf-8
```

------

### 6. å¸è½½è½¯ä»¶åŒ…

#### é€šè¿‡æ–‡ä»¶æŸ¥æ‰¾æ‰€å±åŒ…ï¼š

```bash
rpm -qf /usr/bin/lftp
```

#### å¸è½½è½¯ä»¶ï¼š

```bash
rpm -e lftp
```

> âš ï¸ å¦‚æœå­˜åœ¨ä¾èµ–å…³ç³»ï¼ˆå¦‚ `vim-common`ï¼‰ï¼Œéœ€å…ˆå¸è½½ä¾èµ–çš„ä¸Šå±‚åŒ…ã€‚

------

## äºŒã€YUM è½¯ä»¶ç®¡ç†ï¼ˆè‡ªåŠ¨è§£å†³ä¾èµ–ï¼‰

### é…ç½®è·¯å¾„ï¼š

```bash
/etc/yum.repos.d/
```

------

### æŒ‚è½½å…‰ç›˜é…ç½®æœ¬åœ° yum æº

ç¼–è¾‘æˆ–æ–°å»º `/etc/yum.repos.d/local.repo`ï¼š

```ini
[c7-media]
name=CentOS-$releasever - Media
baseurl=file:///mnt/cdrom
enabled=1
gpgcheck=0
```

> `baseurl` æŒ‡å‘æŒ‚è½½ç›®å½•è·¯å¾„
>  `gpgcheck=0` å…³é—­ GPG æ ¡éªŒ

------

### å¸¸ç”¨å‘½ä»¤ï¼š

```bash
yum clean all        # æ¸…ç†ç¼“å­˜
yum makecache        # é‡å»ºç¼“å­˜
yum install httpd    # å®‰è£… httpd
yum remove httpd     # å¸è½½ httpd
```

------

## ä¸‰ã€ç»ƒä¹ ä»»åŠ¡å»ºè®®ï¼š

1. RPM åŒ…çš„å®‰è£…ã€æŸ¥çœ‹ã€å¸è½½ç»ƒä¹ 
2. lftp å­—ç¬¦é›†ä¹±ç å¤„ç†
3. Vim ç¼–è¾‘å™¨å¸¸è§„ç»ƒä¹ 
4. CentOS/Kali ç½‘ç»œ YUM æºé…ç½®åŠè½¯ä»¶æ›´æ–°

------

## å››ã€ç”¨æˆ·ä¸ç»„ç®¡ç†

### ç”¨æˆ·ç±»å‹

| ç±»å‹         | UID èŒƒå›´        | è¯´æ˜                             |
| ------------ | --------------- | -------------------------------- |
| è¶…çº§ç”¨æˆ·     | 0               | root ç”¨æˆ·                        |
| æ™®é€šç”¨æˆ·     | â‰¥1000ï¼ˆCentOSï¼‰ | å¯ç™»å½•ï¼Œæœ‰å®¶ç›®å½•                 |
| ç³»ç»ŸæœåŠ¡ç”¨æˆ· | 1â€“999           | ä¸å¯ç™»å½•ï¼Œæ— å®¶ç›®å½•ï¼Œåå°æœåŠ¡ä½¿ç”¨ |

------

### ä¸‰å¤§å…³é”®æ–‡ä»¶

#### `/etc/passwd`

```bash
root:x:0:0:root:/root:/bin/bash
```

å­—æ®µè§£é‡Šï¼š

| å­—æ®µåºå· | å«ä¹‰                   |
| -------- | ---------------------- |
| 1        | ç”¨æˆ·å                 |
| 2        | å ä½ç¬¦ï¼ˆä»¥å‰ç”¨äºå¯†ç ï¼‰ |
| 3        | UID                    |
| 4        | GID                    |
| 5        | æ³¨é‡Šè¯´æ˜               |
| 6        | å®¶ç›®å½•                 |
| 7        | é»˜è®¤ shellï¼ˆè§£é‡Šå™¨ï¼‰   |

> **å¦‚æœç›´æ¥ä¼ªé€ æ ¼å¼æ·»åŠ ç”¨æˆ·ï¼Ÿ**
>  ä¸å»ºè®®æ‰‹åŠ¨ç¼–è¾‘ `/etc/passwd`ï¼Œåº”ä½¿ç”¨ `useradd`ã€`usermod` å‘½ä»¤ã€‚å¦åˆ™ç¼ºå°‘å½±å­å¯†ç æ–‡ä»¶ `/etc/shadow` å¯¹åº”ä¿¡æ¯ï¼Œå°†å¯¼è‡´æ— æ³•ç™»å½•æˆ–ç³»ç»Ÿä¸è¯†åˆ«ã€‚

------

#### `/etc/shadow`

```bash
allen:$6$NKiIdkd5k94tho1q$J3DRh2KYU...::0:99999:7:::
```

å­—æ®µè¯´æ˜ï¼š

| å­—æ®µ | å«ä¹‰                                   |
| ---- | -------------------------------------- |
| 1    | ç”¨æˆ·å                                 |
| 2    | å¯†ç å¯†æ–‡ï¼ˆå«åŠ å¯†ç®—æ³•æ ‡è®°ï¼‰             |
| 3    | æœ€åä¿®æ”¹å¯†ç çš„æ—¥æœŸï¼ˆä» 1970 èµ·çš„å¤©æ•°ï¼‰ |
| 4    | æœ€çŸ­å¯†ç ä½¿ç”¨å¤©æ•°                       |
| 5    | æœ€é•¿ä½¿ç”¨å¤©æ•°                           |
| 6    | å¯†ç è¿‡æœŸå‰æç¤ºå¤©æ•°                     |
| 7    | å¯†ç å¤±æ•ˆå®½é™å¤©æ•°                       |
| 8    | è´¦æˆ·å¤±æ•ˆæ—¥æœŸ                           |

##### å¯†ç åŠ å¯†éªŒè¯æ–¹å¼ï¼ˆPython æ¨¡æ‹Ÿï¼‰ï¼š

```python
import crypt
crypt.crypt('123456', '$6$NKiIdkd5k94tho1q')
```

> `$6$` è¡¨ç¤º SHA-512 åŠ å¯†ç®—æ³•

------

#### `/etc/group`

ç»„æˆå‘˜ç®¡ç†å‘½ä»¤ï¼š

```bash
gpasswd -a allen root     # æŠŠ allen åŠ å…¥ root ç»„
gpasswd -d allen root     # æŠŠ allen ä» root ç»„ç§»é™¤
```

------

### æ·»åŠ ç”¨æˆ·ä¸ç»„ç»ƒä¹ 

#### 1. åˆ›å»ºç»„ top2022ï¼ŒGID ä¸º 2000

```bash
groupadd -g 2000 top2022
```

#### 2. åˆ›å»ºç»„ top2023ï¼Œå†æ·»åŠ ç”¨æˆ· allonï¼š

```bash
groupadd top2023
useradd allon -u 1500 -g top2022 -G top2023
```

> `-g` æŒ‡å®šä¸»ç»„ï¼Œ`-G` æŒ‡å®šé™„åŠ ç»„

#### 3. ä¸ºç”¨æˆ·è®¾ç½®å¯†ç ï¼š

```bash
passwd allon
```

è¾“å…¥ä¸¤æ¬¡å¯†ç  `123.com`

#### 4. åˆ é™¤ç”¨æˆ·

```bash
userdel allon
```

------

# 7.22ä¸Š

------

# Linux æƒé™ä¸ææƒå®éªŒæ€»ç»“

## 1. æƒé™åŸºç¡€

| æƒé™å­—ç¬¦ | è¯´æ˜            | æ–‡ä»¶ä½œç”¨ | ç›®å½•ä½œç”¨       |
| -------- | --------------- | -------- | -------------- |
| `r`      | è¯»å–ï¼ˆreadï¼‰    | æŸ¥çœ‹å†…å®¹ | åˆ—å‡ºç›®å½•å†…å®¹   |
| `w`      | å†™å…¥ï¼ˆwriteï¼‰   | ä¿®æ”¹å†…å®¹ | åˆ›å»ºã€åˆ é™¤æ–‡ä»¶ |
| `x`      | æ‰§è¡Œï¼ˆexecuteï¼‰ | è¿è¡Œæ–‡ä»¶ | è¿›å…¥ç›®å½•       |

> **æ³¨æ„ï¼š** `w` æƒé™å¯¹ç›®å½•æ¥è¯´å¾ˆæ•æ„Ÿï¼Œæ„å‘³ç€æœ‰åˆ é™¤è¯¥ç›®å½•ä¸­æ–‡ä»¶çš„æƒé™ã€‚

------

## 2. æƒé™å®ä¾‹åˆ†æ

ç¤ºä¾‹ï¼š

```bash
ll -d top2109 top2109dir/
```

å‡è®¾ç”¨æˆ· `tom` å’Œ `jerry` éƒ½åŠ å…¥äº† `root` ç»„ï¼š

- `top2109` æ˜¯æ–‡ä»¶ï¼Œ`top2109dir/` æ˜¯ç›®å½•ã€‚
- `tom`ï¼šåªæœ‰è¯»æƒé™ï¼ˆä¸å¯å†™ã€ä¸å¯æ‰§è¡Œï¼‰
- `jerry`ï¼šè¯» + å†™æƒé™ï¼ˆä¸å¯æ‰§è¡Œï¼‰

------

## 3. æƒé™ä¿®æ”¹å‘½ä»¤ï¼ˆchmodï¼‰

- ä¿®æ”¹ç»„æƒé™ï¼š
   `chmod g+w,o-r top2109`
- å°†ç»„æƒé™æ¸…ç©ºï¼š
   `chmod g=--- top2109`

æƒé™æ ‡è®°å«ä¹‰ï¼š
 `r`ï¼ˆè¯»ï¼‰ `w`ï¼ˆå†™ï¼‰ `x`ï¼ˆæ‰§è¡Œï¼‰
 `s`ï¼ˆSUID/SGIDï¼‰ `t`ï¼ˆSticky bitï¼‰

------

## 4. ç»ƒä¹ ï¼šæƒé™éªŒè¯

### âœ… root åˆ›å»ºæ–‡ä»¶/ç›®å½•æƒé™éªŒè¯

1. root åˆ›å»ºæ–‡ä»¶ `top2109` å’Œç›®å½• `top2109dir`ï¼š

   ```bash
   touch top2109
   mkdir top2109dir
   ll -d top2109 top2109dir
   ```

2. tom æ— æ³•ä¿®æ”¹ top2109dirï¼ˆæ—  `w` æƒé™ï¼‰

### âš ï¸ æœ‰äº‰è®®çš„æƒé™ï¼šç›®å½• `other=rw-`

- ä¸èƒ½è¿›å…¥ç›®å½•ï¼ˆæ—  `x`ï¼‰
- ä¸èƒ½ä¿®æ”¹å†…å®¹ï¼ˆæ— æƒé™ï¼‰
- å¯ä»¥æŸ¥çœ‹ï¼Ÿ â†’ ä¸è¡Œï¼Œå› ä¸º `ls` éœ€è¦æ‰§è¡Œæƒé™

------

## 5. ç‰¹æ®Šæƒé™å®éªŒï¼šSticky ä½

ç›®å½•æƒé™ç»™äº†æ‰€æœ‰ç”¨æˆ· `w`ï¼Œæ„å‘³ç€ä»»ä½•äººå¯åˆ é™¤å…¶ä»–äººçš„æ–‡ä»¶ã€‚

```bash
mkdir dangerous_dir
chmod 777 dangerous_dir
touch dangerous_dir/root_file
chown root dangerous_dir/root_file

# tom å¯ä»¥åˆ é™¤ root çš„æ–‡ä»¶
su - tom
rm dangerous_dir/root_file
```

### é˜²æŠ¤æ–¹æ¡ˆï¼š

æ·»åŠ  Sticky ä½ï¼š

```bash
chmod +t dangerous_dir
```

------

## 6. æƒé™ç»ƒä¹ 

### ç»ƒä¹ 1ï¼š

```bash
# ä¿®æ”¹ç›®å½•æƒé™
chmod g+w,o-wx top2109dir
chmod g=rw-,o=--- top2109dir
```

è®© `tom/jerry` åˆ†åˆ«æµ‹è¯• `cd`ã€`ls`ã€åˆ›å»º/åˆ é™¤æ–‡ä»¶æ˜¯å¦æˆåŠŸã€‚

### ç»ƒä¹ 2ï¼š

#### è‡ªå»ºç›®å½•éªŒè¯

```bash
mkdir testdir
chmod 733 testdir
# tom åˆ é™¤å…¶ä»–äººçš„æ–‡ä»¶
```

#### /tmp ç›®å½•éªŒè¯

```bash
ls -ld /tmp  # é»˜è®¤åº”ä¸º 1777
```

------

## 7. æƒé™æ˜¯ä»å·¦å‘å³ç”Ÿæ•ˆ

```bash
chmod u=--- myfile
# å³ä½¿æ˜¯æ‰€æœ‰è€…ä¹Ÿæ²¡æœ‰æƒé™è®¿é—®
```

------

## 8. å¸¸ç”¨æƒé™è®¾ç½®

```bash
chmod 755 top2109       # æ–‡ä»¶ï¼šrwxr-xr-x
chmod 644 root.txt      # æ–‡ä»¶ï¼šrw-r--r--
```

------

## 9. å…«è¿›åˆ¶æƒé™å¯¹ç…§è¡¨

| æ•°å­— | äºŒè¿›åˆ¶ | å«ä¹‰ |
| ---- | ------ | ---- |
| 0    | 000    | ---  |
| 1    | 001    | --x  |
| 2    | 010    | -w-  |
| 3    | 011    | -wx  |
| 4    | 100    | r--  |
| 5    | 101    | r-x  |
| 6    | 110    | rw-  |
| 7    | 111    | rwx  |

------

## 10. æ™®é€šç”¨æˆ· vs ç®¡ç†å‘˜ åˆ›å»ºæƒé™å·®å¼‚ï¼Ÿ

| ç±»å‹ | é»˜è®¤æƒé™ | æ¥æºï¼ˆæœ€å¤§æƒé™ - umaskï¼‰ |
| ---- | -------- | ------------------------ |
| æ–‡ä»¶ | 666      | å¯è¯»å¯å†™                 |
| ç›®å½• | 777      | å¯è¯»å¯å†™å¯æ‰§è¡Œ           |

------

## 11. umask æƒé™æ©ç 

| umask | åˆ›å»ºç›®å½•æƒé™ | åˆ›å»ºæ–‡ä»¶æƒé™ |
| ----- | ------------ | ------------ |
| 002   | 775          | 664          |
| 022   | 755          | 644          |
| 0077  | 700          | 600          |

### æŸ¥çœ‹å’Œä¿®æ”¹ umask

```bash
umask          # æŸ¥çœ‹å½“å‰å€¼
umask 0077     # ä¿®æ”¹å½“å‰ shell çš„æ©ç 
```

é…ç½®æ–‡ä»¶ï¼š

- `/etc/profile`
- `/etc/bashrc`

------

## 12. å®¶ç›®å½•ç®¡ç†

```bash
useradd -d /home/anyuser bob
rm -rf /home/anyuser

# bob ç™»å½•åæç¤ºæ— å®¶ç›®å½•ï¼Œä½¿ç”¨ /
```

### æ¢å¤å®¶ç›®å½•

```bash
mkdir /home/bob
cp -r /etc/skel/.[a-z]* /home/bob
chown -R bob:bob /home/bob
```

------

## 13. æ‰€å±ç»„ä¸æ‰€æœ‰è€…ä¿®æ”¹

```bash
# ä¿®æ”¹ç»„
chgrp lisa top2109

# ä¿®æ”¹æ‰€æœ‰è€…å’Œç»„
chown jerry:jerry top2209dir/
```

------

## 14. ç»¼åˆç»ƒä¹ é¢˜å»ºè®®

1. åˆ›å»ºç”¨æˆ· bobï¼ŒæŒ‡å®šå®¶ç›®å½• `/home/anyuser`
2. ç”¨ root åˆ é™¤ bob çš„å®¶ç›®å½•
3. åˆ‡æ¢ bob ç”¨æˆ·è§‚å¯Ÿç°è±¡
4. æ‰‹åŠ¨å»ºç«‹ `/home/bob`
5. ä½¿ç”¨ skel æ¨¡æ¿æ¢å¤é»˜è®¤ç»“æ„
6. ä¿®æ”¹æ‰€æœ‰è€…å’Œç»„ä¸º bob
7. åˆ‡æ¢ bob ç”¨æˆ·éªŒè¯æ˜¯å¦æ¢å¤æˆåŠŸ

------

# 7.21ä¸‹

------

# Linux ç‰¹æ®Šæƒé™ä¸ææƒæœºåˆ¶æ€»ç»“

## 1. ç‰¹æ®Šæƒé™æ¦‚è§ˆ

| æƒé™ä½ | æ•°å€¼ | å«ä¹‰                                                         |
| ------ | ---- | ------------------------------------------------------------ |
| SUID   | 4    | å¯æ‰§è¡Œæ–‡ä»¶ï¼šä»¥ **æ–‡ä»¶æ‰€æœ‰è€…èº«ä»½** æ‰§è¡Œç¨‹åºï¼ˆä»…é™äºŒè¿›åˆ¶ï¼‰     |
| SGID   | 2    | **ç›®å½•**ï¼šæ–°å»ºæ–‡ä»¶ç»§æ‰¿ç›®å½•æ‰€å±ç»„ï¼›**æ–‡ä»¶**ï¼šæ‰§è¡Œæ—¶ä»¥æ–‡ä»¶ç»„èº«ä»½è¿è¡Œ |
| Sticky | 1    | **ç›®å½•**ï¼šåªæœ‰æ–‡ä»¶æ‹¥æœ‰è€…æ‰èƒ½åˆ é™¤è‡ªå·±çš„æ–‡ä»¶                   |

è®¾ç½®ç¤ºä¾‹ï¼š

```bash
# æ·»åŠ ç²˜æ»ä½ï¼ˆSticky Bitï¼‰
chmod 1777 top2109dir/

# ç§»é™¤ç²˜æ»ä½
chmod o-t top2109dir

# æ·»åŠ  SGIDï¼ˆç»„ç»§æ‰¿ï¼‰
chmod 2777 top2109dir/

# æ·»åŠ  SUIDï¼ˆæƒé™æå‡ï¼‰
chmod 4755 /usr/bin/æŸå¯æ‰§è¡Œæ–‡ä»¶
```

------

## 2. SUID ç¤ºä¾‹å®éªŒ

### SUID åŸç†è¯´æ˜ï¼š

> **æ™®é€šç”¨æˆ·æ‰§è¡ŒæŸæ–‡ä»¶æ—¶ï¼Œä»¥æ–‡ä»¶æ‰€æœ‰è€…èº«ä»½è¿è¡Œã€‚**

### å®éªŒï¼šcat æ·»åŠ  SUID æŸ¥çœ‹ `/etc/shadow`

```bash
which cat         # ç¡®è®¤è·¯å¾„
chmod 4755 /usr/bin/cat

# jerry ç”¨æˆ·æ‰§è¡Œ
cat /etc/shadow   # æˆåŠŸè¯»å–ï¼ˆåº”ä¸º root æƒé™ï¼‰
```

> âš ï¸ **é£é™©æå¤§ï¼Œä¸æ¨èå¯¹ä»»æ„ç¨‹åºæ·»åŠ  SUIDï¼**

------

## 3. æŸ¥æ‰¾ç³»ç»Ÿä¸­ SUID ç¨‹åº

```bash
# æŸ¥æ‰¾å…¨ç³»ç»Ÿ SUID ç¨‹åº
find / -perm -u=s -type f 2>/dev/null

# æˆ–è€…ç®€å†™ä¸ºï¼š
find / -perm -4000 -type f 2>/dev/null
```

### å¸¸è§ SUID ç¨‹åºï¼ˆä¾‹ï¼‰ï¼š

```bash
ls -l /usr/bin/passwd
-rwsr-xr-x 1 root root ... /usr/bin/passwd
```

è¯´æ˜ï¼š

- å±ä¸»ä¸º root
- æ‹¥æœ‰ SUIDï¼ˆ`s` æ›¿ä»£ `x`ï¼‰
- æ™®é€šç”¨æˆ·è¿è¡Œè¯¥å‘½ä»¤ä¼šä¸´æ—¶ä»¥ root èº«ä»½æ‰§è¡Œ

------

## 4. SGID ç¤ºä¾‹å®éªŒ

```bash
chmod 2777 /testdir
# jerry åœ¨ testdir ä¸­åˆ›å»ºæ–‡ä»¶ï¼Œä¼šç»§æ‰¿ testdir çš„æ‰€å±ç»„
```

------

## 5. ç²˜æ»ä½ Sticky Bit ç¤ºä¾‹

```bash
mkdir /tmp/testdir
chmod 1777 /tmp/testdir

# jerry å’Œ tom éƒ½å¯ä»¥å†™æ–‡ä»¶ï¼Œä½†åªèƒ½åˆ é™¤è‡ªå·±çš„
```

------

## 6. æƒé™ç»„åˆå¯¹æ¯”

| æƒé™æ•°å€¼ | è¯´æ˜                               | å®‰å…¨æ€§ | ç”¨é€”                   |
| -------- | ---------------------------------- | ------ | ---------------------- |
| `0777`   | æ‰€æœ‰äººå¯è¯»å†™åˆ ï¼Œæ— é™åˆ¶             | âŒ å±é™© | ç¦ç”¨ï¼ˆæä¸å®‰å…¨ï¼‰       |
| `1777`   | ç²˜æ»ä½ï¼Œæ‰€æœ‰äººå¯å†™ï¼Œä¸èƒ½åˆ ä»–äººæ–‡ä»¶ | âœ… å®‰å…¨ | `/tmp` ç­‰å…¬å…±ä¸´æ—¶ç›®å½•  |
| `2777`   | SGID ä½ï¼Œæ–‡ä»¶è‡ªåŠ¨ç»§æ‰¿ç›®å½•ç»„        | âš ï¸ ä¸­ç­‰ | å°ç»„åä½œç›®å½•ï¼ˆéœ€è°¨æ…ï¼‰ |
| `3777`   | SGID + ç²˜æ»ä½ï¼Œç»„ç»§æ‰¿+å®‰å…¨åˆ é™¤æœºåˆ¶ | âœ… æ¨è | å®‰å…¨å…±äº«ç›®å½•           |

------

## 7. sudo ææƒæœºåˆ¶

### åœºæ™¯ï¼šjerry ä¸èƒ½å…³é—­æœåŠ¡

```bash
jerry:
systemctl stop autofs     # æƒé™ä¸è¶³

root:
visudo                    # å®‰å…¨ä¿®æ”¹ sudo é…ç½®
```

### é…ç½® sudo æƒé™+ä¸è¦å¯†ç 

```bash
# ç¼–è¾‘ /etc/sudoers ä½¿ç”¨ visudo
NOPASSWD:jerry    ALL=(ALL)    /usr/bin/systemctl

# å¤šæ¡å‘½ä»¤ï¼š
jerry    ALL=(ALL)    /usr/bin/systemctl, /usr/bin/vim

# ç”¨æˆ·æ‰€å±ç»„æˆæƒï¼š
%wheel  ALL=(ALL)     ALL
```

æŸ¥çœ‹ jerry æ‹¥æœ‰å“ªäº› sudo æƒé™ï¼š

```bash
sudo -l
```

------

## 8. find å‘½ä»¤ sudo ææƒæ¼”ç¤º

### root è®¾ç½®

```bash
visudo

jerry    ALL=(ALL)    /usr/bin/find
```

### jerry ç”¨æˆ·ä½¿ç”¨ï¼š

```bash
sudo find /boot -size +3M -type f -exec /bin/bash \;
```

> ğŸ’¡ å¯ä»¥é€šè¿‡ `-exec` æ‰§è¡Œå…¶ä»–å‘½ä»¤ï¼Œä»è€Œé—´æ¥è·å¾—æ›´é«˜æƒé™ã€‚

------

## 9. æ€»ç»“ï¼šç‰¹æ®Šæƒé™å¯¹æ¯”è¡¨

| ç‰¹æ®Šæƒé™ | ç±»å‹      | ä½œç”¨èŒƒå›´             | æƒé™å­—ç¬¦è¡¨ç¤º | æ•°å€¼ | ç¤ºä¾‹å‘½ä»¤                     |
| -------- | --------- | -------------------- | ------------ | ---- | ---------------------------- |
| SUID     | æ–‡ä»¶      | ç¨‹åºä»¥å±ä¸»èº«ä»½è¿è¡Œ   | `s` æ›¿ä»£ `x` | 4    | `chmod 4755 /usr/bin/passwd` |
| SGID     | æ–‡ä»¶/ç›®å½• | æ–‡ä»¶åŒä¸Šï¼Œç›®å½•ç»§æ‰¿ç»„ | `s` æ›¿ä»£ `x` | 2    | `chmod 2777 /project`        |
| Sticky   | ç›®å½•      | é™åˆ¶åˆ é™¤æƒé™         | `t` æ›¿ä»£ `x` | 1    | `chmod 1777 /tmp`            |

------



# 7.22

------

# Linux ç³»ç»Ÿç®¡ç†ä¸ç½‘ç»œé…ç½®ç¬”è®°

## ä¸€ã€æ–‡ä»¶åˆ é™¤æƒé™ç›¸å…³

### ç²˜æ»ä½ï¼ˆSticky Bitï¼‰

- å¦‚æœå½“å‰ç›®å½•è®¾ç½®äº†ç²˜æ»ä½ï¼ˆSticky Bitï¼Œ`t`ï¼‰ï¼Œå³è¯¥ç›®å½•çš„æƒé™ç±»ä¼¼å¦‚ä¸‹ï¼š

  ```bash
  drwxrwxrwt
  ```

- åˆ™åªæœ‰ä»¥ä¸‹ä¸‰ç§ç”¨æˆ·æ‰èƒ½åˆ é™¤ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼š

  - æ–‡ä»¶çš„æ‰€æœ‰è€…
  - ç›®å½•çš„æ‰€æœ‰è€…
  - `root` ç”¨æˆ·

**é—®é¢˜ï¼š**

> æ™®é€šç”¨æˆ· `tom` å±äº `root` ç»„ï¼Œèƒ½å¦åˆ é™¤ `jerry` ç”¨æˆ·çš„æ–‡ä»¶ï¼Ÿ

**ç­”æ¡ˆï¼š** ä¸èƒ½ï¼å³ä¾¿ `tom` æ˜¯ `root` ç»„çš„æˆå‘˜ï¼Œåªè¦ä¸æ˜¯æ–‡ä»¶æ‰€æœ‰è€…ã€ç›®å½•æ‰€æœ‰è€…æˆ–çœŸæ­£çš„ root ç”¨æˆ·ï¼Œå°±ä¸èƒ½åˆ é™¤å…¶ä»–ç”¨æˆ·çš„æ–‡ä»¶ã€‚

------

## äºŒã€å¿˜è®° root å¯†ç çš„æ•‘æ´æ–¹æ³•

### 1. é‡å¯è¿›å…¥ GRUB å¼•å¯¼èœå•

- é‡å¯ç³»ç»Ÿï¼Œåœ¨ GRUB èœå•ç•Œé¢æŒ‰ `e` è¿›å…¥ç¼–è¾‘æ¨¡å¼ã€‚
- ä¿®æ”¹å†…æ ¸å‚æ•°ï¼š
  - æ‰¾åˆ°ä»¥ `linux16` å¼€å¤´çš„ä¸€è¡Œï¼ˆæˆ– `linux`ï¼‰ã€‚
  - æŠŠ `ro` ä¿®æ”¹ä¸º `rw`
  - æœ«å°¾æ·»åŠ ï¼š`rd.break`
- æŒ‰ `Ctrl + X` å¯åŠ¨è¿›å…¥æ•‘æ´æ¨¡å¼ã€‚

### 2. æ•‘æ´æ¨¡å¼ä¸‹æ“ä½œ

```bash
# æŒ‚è½½æ ¹ç›®å½•
chroot /sysroot

# æ¸…é™¤ root å¯†ç 
passwd -d root

# åˆ›å»ºé‡æ ‡è®°æ–‡ä»¶ï¼Œé‡å¯åç³»ç»Ÿä¼šé‡æ–°è®¾ç½® SELinux æ ‡ç­¾
touch /.autorelabel

# é€€å‡ºå¹¶é‡å¯ç³»ç»Ÿ
exit
reboot
```

------

## ä¸‰ã€GRUB å¯†ç ä¿æŠ¤é…ç½®

### GRUB æ–‡ä»¶ä½ç½®

- `/boot/grub/`
- `/boot/grub2/`

### æ·»åŠ  GRUB å¯†ç ç”¨æˆ·

1. ç¼–è¾‘ `/etc/grub.d/10_linux` æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼ˆä¸è¦ç›´æ¥ç¼–è¾‘è¯¥æ–‡ä»¶ä¸»ä½“ï¼Œæ·»åŠ åˆ°æœ«å°¾ï¼‰ï¼š

   ```bash
   cat << EOF
   set superusers="bob"
   export superusers
   password_pbkdf2 bob grub.pbkdf2.sha512.10000.XXXX
   EOF
   ```

2. æ›´æ–° grub é…ç½®æ–‡ä»¶ï¼š

   ```bash
   grub2-mkconfig -o /boot/grub2/grub.cfg
   ```

------

## å››ã€Kali Linux æ•‘æ´æ¨¡å¼å¿«é€Ÿè¿›å…¥ root æƒé™

1. grub èœå•æŒ‰ `e` ç¼–è¾‘

2. å°† `ro` æ”¹ä¸º `rw`

3. æŠŠ `linux` è¡Œæœ«å°¾å†…å®¹åˆ é™¤å¹¶æ·»åŠ ï¼š

   ```bash
   init=/bin/sh
   ```

4. æŒ‰ `Ctrl + X` è¿›å…¥å•ç”¨æˆ·æ¨¡å¼ã€‚

------

## äº”ã€è¿›ç¨‹ç®¡ç†

### å¸¸ç”¨å‘½ä»¤

- `ps aux`ï¼šæŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹  åŠ -lå¤šçº¿ç¨‹
- `pstree -p | grep bash`ï¼šæ ‘çŠ¶ç»“æ„æŸ¥çœ‹è¿›ç¨‹
- `kill -9 PID`ï¼šå¼ºåˆ¶æ€æ­»è¿›ç¨‹
- `top`ï¼šå®æ—¶è¿›ç¨‹ç›‘æ§ï¼ˆè¾“å…¥ `k` å¯æ€è¿›ç¨‹ï¼‰

### å¸¸ç”¨å¿«æ·é”®

- `Ctrl + Alt + F1`ï¼šå›¾å½¢ç•Œé¢
- `Ctrl + Alt + F2~F6`ï¼šéå›¾å½¢ç»ˆç«¯
- `jobs`ï¼šæŸ¥çœ‹åå°ä»»åŠ¡
- `fg %ç¼–å·`ï¼šæ¢å¤åå°ä»»åŠ¡

### å¼‚å¸¸é€€å‡ºæ–‡ä»¶æ¢å¤

```bash
rm -f .filename.swp
```

------

## å…­ã€systemctl ç®¡ç†æœåŠ¡

```bash
# å¯åŠ¨ã€åœæ­¢ã€æŸ¥çœ‹çŠ¶æ€
systemctl start httpd
systemctl stop httpd
systemctl status httpd

# è®¾ç½®å¼€æœºå¯åŠ¨
systemctl enable httpd

# ç¦ç”¨å¼€æœºå¯åŠ¨
systemctl disable httpd

# æŸ¥çœ‹æ‰€æœ‰å¯ä»¥æ§åˆ¶çš„æœåŠ¡
systemctl list-unit-files
```

------

## ä¸ƒã€ç½‘ç»œåœ°å€é…ç½®ï¼ˆNAT æ¨¡å¼ï¼‰

### 1. ä¸´æ—¶è®¾ç½® IP åœ°å€

```bash
# æŸ¥çœ‹ç½‘å¡ä¿¡æ¯
ip addr show ens33

# åˆ é™¤ IP
ip address del 192.168.133.131/24 dev ens33

# æ·»åŠ  IP
ip address add 192.168.133.131/24 dev ens33

# æŸ¥çœ‹ç½‘å…³è·¯ç”±
ip route

# æŸ¥çœ‹ DNS
cat /etc/resolv.conf
```

### 2. æ°¸ä¹…é…ç½® IP åœ°å€

ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š

```bash
vim /etc/sysconfig/network-scripts/ifcfg-ens33
```

å†…å®¹å¦‚ä¸‹ï¼š

```ini
DEVICE=ens33
TYPE=Ethernet
BOOTPROTO=static
ONBOOT=yes
IPADDR=192.168.133.251
NETMASK=255.255.255.0
GATEWAY=192.168.133.2
DNS1=114.114.114.114
DNS2=8.8.8.8
```

é‡å¯ç½‘ç»œæœåŠ¡ï¼š

```bash
systemctl restart NetworkManager
```

------



# Kali ç½‘ç»œé…ç½®ä¸è®¡åˆ’ä»»åŠ¡ + æ—¥å¿—ç®¡ç†ç¬”è®°

## ğŸ“¡ ç½‘å¡é™æ€ IP é…ç½®ï¼ˆKaliï¼‰

é…ç½®æ–‡ä»¶ï¼š`/etc/network/interfaces`

```conf
auto eth0
iface eth0 inet static
    address 192.168.133.249
    netmask 255.255.255.0
    gateway 192.168.133.2
```

é‡å¯ç½‘ç»œæœåŠ¡ï¼š

```bash
systemctl restart networking.service
```

------

## â° è®¡åˆ’ä»»åŠ¡

### ä¸€æ¬¡æ€§è®¡åˆ’ä»»åŠ¡ï¼ˆatï¼‰

- ç¡®ä¿æœåŠ¡å·²å¯åŠ¨ï¼š

  ```bash
  systemctl status atd
  ```

- è®¾ç½®ä»»åŠ¡ï¼š

  ```bash
  at now + 2min
  at> echo "hello" > /tmp/test.txt
  <Ctrl+D>
  ```

- æŸ¥çœ‹ä»»åŠ¡ï¼š

  ```bash
  at -l        # åˆ—è¡¨
  at -c ä»»åŠ¡å· # æŸ¥çœ‹è¯¦æƒ…
  ```

- æ—¶é—´æ ¼å¼ï¼š`at 12:30 2025-07-21`

------

### å‘¨æœŸæ€§ä»»åŠ¡ï¼ˆcrontabï¼‰

- ç¡®ä¿æœåŠ¡è¿è¡Œï¼š

  ```bash
  systemctl status crond
  ```

- ç¼–è¾‘å‘¨æœŸä»»åŠ¡ï¼š

  ```bash
  crontab -e
  ```

- æŸ¥çœ‹ï¼š

  ```bash
  crontab -l
  crontab -u ç”¨æˆ·å -l
  ```

### ç¤ºä¾‹ï¼š

æ¯å¹´1ã€3ã€5æœˆçš„å‘¨ä¸€åˆ°å‘¨äº”å‡Œæ™¨3ç‚¹ï¼Œæ‰“åŒ… `/var/log/secure` åˆ° `/tmp/test.tar.gz`ï¼š

```cron
0 3 * 1,3,5 1-5 tar -zcf /tmp/test.tar.gz /var/log/secure
```

------

## â³ ç»ƒä¹ ç¤ºä¾‹ï¼š

7æœˆ23æ—¥ 10:00â€“11:00 æ¯åˆ†é’Ÿå¤‡ä»½ä¸€æ¬¡ `/var/log/source` æ—¥å¿—ï¼š

```cron
* 10-11 23 7 * cd /var/log && tar -zcf /tmp/source_`date +\%H:\%M`.tar.gz source
```

------

## ğŸ§¾ æ—¥å¿—ç³»ç»Ÿï¼ˆrsyslogï¼‰

### æ ¸å¿ƒæ—¥å¿—è·¯å¾„ï¼š

- `/var/log/secure`ï¼šè®°å½•è®¤è¯å’Œå®‰å…¨ç›¸å…³æ—¥å¿—

### é…ç½®æ–‡ä»¶ï¼š

- `/etc/rsyslog.conf`

### æ—¥å¿—è§„åˆ™è¯­æ³•ï¼š

```
facility.level      destination
```

### ç¤ºä¾‹è§„åˆ™ï¼š

```conf
authpriv.*     /var/log/secure
*.emerg        :omusrmsg:*
```

------

### æ‰‹åŠ¨è§¦å‘æ—¥å¿—å†™å…¥ï¼š

```bash
logger -p authpriv.error "+++error log+++"
logger -p authpriv.emerg "+++emerg log+++"
```

------

## ğŸŒ æ—¥å¿—é›†ä¸­ç®¡ç†ï¼ˆè¿œç¨‹ï¼‰

### å®¢æˆ·ç«¯é…ç½®ï¼ˆå‘é€æ—¥å¿—åˆ°è¿œç¨‹ï¼‰ï¼š

`/etc/rsyslog.conf` ä¸­æ·»åŠ ï¼š

```conf
authpriv.* @@192.168.1.200:514
```

### æœåŠ¡å™¨ç«¯é…ç½®ï¼ˆæ¥æ”¶å¹¶å¤„ç†æ—¥å¿—ï¼‰ï¼š

- å–æ¶ˆç›‘å¬ TCP 514 çš„æ³¨é‡Šï¼š

```conf
module(load="imtcp")
input(type="imtcp" port="514")
```

- æ·»åŠ æ—¥å¿—ç­›é€‰è§„åˆ™ï¼š

```conf
:msg, contains, "Failed password" /var/log/class1/class2.txt
```

------



# LinuxåŠ¨æ€ç½‘ç«™æ­å»ºæ•™ç¨‹

## ä¸€ã€LAMP/LNMPåŸºç¡€ä»‹ç»

- **LAMPæ¶æ„ï¼š**
  - Lï¼šLinux ç³»ç»Ÿ
  - Aï¼šApacheï¼ˆWebæœåŠ¡å™¨ï¼‰
  - Mï¼šMySQL/MariaDBï¼ˆæ•°æ®åº“ï¼‰
  - Pï¼šPHPï¼ˆè„šæœ¬è¯­è¨€ï¼‰
- **LNMPæ¶æ„ï¼š**
  - Lï¼šLinux
  - Nï¼šNginxï¼ˆWebæœåŠ¡å™¨ï¼‰
  - Mï¼šMySQL/MariaDB
  - Pï¼šPHP

> é™æ€ç½‘ç«™åªéœ€è¦ Apacheï¼›åŠ¨æ€ç½‘ç«™éœ€è¦æ•°æ®åº“å’ŒPHPåšæ¡¥æ¥ã€‚

------

## äºŒã€Apacheå®‰è£…ä¸é…ç½®

### 1. å®‰è£…Apache

```bash
yum -y install httpd
```

### 2. æŸ¥çœ‹è½¯ä»¶å®‰è£…è·¯å¾„å’Œä¸»é…ç½®æ–‡ä»¶

```bash
rpm -ql httpd
ä¸»é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/etc/httpd/conf/httpd.conf
é»˜è®¤å‘å¸ƒè·¯å¾„ï¼š/var/www/html
```

### 3. å¿«é€ŸæŸ¥çœ‹æœ‰æ•ˆé…ç½®å†…å®¹ï¼ˆå»æ³¨é‡Šå’Œç©ºè¡Œï¼‰

```bash
grep -v "#" /etc/httpd/conf/httpd.conf | grep -v ^$
```

### 4. httpd.conf é…ç½®é‡ç‚¹

| é…ç½®é¡¹                                 | è¯´æ˜               |
| -------------------------------------- | ------------------ |
| `ServerRoot "/etc/httpd"`              | ä¸»ç›®å½•             |
| `Listen 80`                            | ç›‘å¬ç«¯å£           |
| `User apache`                          | å¯åŠ¨æœåŠ¡ç”¨æˆ·       |
| `Group apache`                         | å¯åŠ¨æœåŠ¡ç»„         |
| `DocumentRoot "/var/www/html"`         | é»˜è®¤ç½‘é¡µæ ¹ç›®å½•     |
| `<Directory "/var/www/html">`          | æ§åˆ¶ç›®å½•æƒé™å’Œè¡Œä¸º |
| `DirectoryIndex index.html`            | é»˜è®¤ç½‘é¡µæ–‡ä»¶       |
| `CustomLog "logs/access_log" combined` | æ—¥å¿—ä½ç½®ä¸æ ¼å¼     |

### 5. å¯åŠ¨ä¸é‡å¯æœåŠ¡

```bash
systemctl start httpd
systemctl restart httpd
```

------

## ä¸‰ã€Apacheè®¿é—®æ§åˆ¶ç¤ºä¾‹

### 1. æ‹’ç»æŸIPæ®µè®¿é—®

**æ–¹æ³•ä¸€ï¼šä½¿ç”¨ `Require not ip`**

```apache
<Directory "/var/www/html">
    Options Indexes FollowSymLinks
    AllowOverride None
    <RequireAll>
        Require all granted
        Require not ip 192.168.126.0/24
    </RequireAll>
</Directory>
```

**æ–¹æ³•äºŒï¼šä¼ ç»Ÿæ–¹å¼ï¼ˆéœ€æ”¯æŒï¼‰**

```apache
Order Deny,Allow
Deny from 192.168.133.1
```

### 2. å‘å¸ƒç½‘ç«™ & æŸ¥çœ‹è®¿é—®æ—¥å¿—

```bash
è®¿é—®æ—¥å¿—ï¼š/var/log/httpd/access_log
é”™è¯¯æ—¥å¿—ï¼š/var/log/httpd/error_log
```

------

## å››ã€MariaDBæ•°æ®åº“æ“ä½œ

### 1. å®‰è£…ä¸å¯åŠ¨

```bash
yum -y install mariadb-server
systemctl start mariadb
```

é»˜è®¤ç«¯å£ï¼š`3306`

### 2. åŸºæœ¬æ•°æ®åº“æ“ä½œ

```sql
-- æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“
show databases;

-- è¿›å…¥æ•°æ®åº“
use mysql;

-- æŸ¥çœ‹è¡¨
show tables;

-- æŸ¥çœ‹å­—æ®µ
desc mysql.user;

-- åˆ›å»ºæ•°æ®åº“
create database class1;

-- åˆ›å»ºè¡¨
create table class1.users(
  id int auto_increment,
  name varchar(15),
  age int,
  sex enum('b','g'),
  tel varchar(15),
  primary key(id)
);
```

### 3. å¢åˆ æ”¹æŸ¥ç¤ºä¾‹

```sql
-- æ’å…¥æ•°æ®
insert into class1.users(name, age, sex, tel) value('tom', 26, 'b', 12345678901);

-- æ›´æ–°æ•°æ®
update class1.users set tel='13838383838' where id=1;

-- æŸ¥è¯¢æ‰€æœ‰å¥³å­©
select name, tel from class1.users where sex='g';

-- æŸ¥è¯¢å¹´é¾„<20çš„å¥³å­©
select name, tel from class1.users where sex='g' and age<20;

-- åˆ†é¡µæŸ¥è¯¢
select name, tel from class1.users limit 0,1;

-- åˆ é™¤ç”¨æˆ·
delete from class1.users where id=3;

-- åˆ é™¤è¡¨
drop table class1.users;

-- åˆ é™¤åº“
drop database class1;
```

------

## äº”ã€æ•°æ®åº“å¤‡ä»½ä¸æ¢å¤

### 1. å¤‡ä»½æ•°æ®åº“

```bash
mysqldump -u root -p123456 class1 users > /tmp/class1.users.sql
```

### 2. æ¢å¤æ•°æ®åº“

```bash
# åœ¨bashä¸­
mysql -u root -p123456 class1 < /tmp/class1.users.sql
# æˆ–è€…åœ¨ mysql å‘½ä»¤è¡Œå†…ï¼š
source /tmp/class1.users.sql;
```

------

## å…­ã€PHPå®‰è£…ä¸é…ç½®

### 1. å®‰è£…PHPåŠæ¨¡å—

```bash
yum -y install php php-mysql php-mbstring
```

### 2. å¼€å¯çŸ­æ ‡è®°åŠŸèƒ½

#### ç¼–è¾‘   ***phpé…ç½®æ–‡ä»¶***  `  /etc/php.ini`ï¼Œæ‰¾åˆ°ï¼š

```ini
short_open_tag = On
```

### 3. æµ‹è¯•PHPæ˜¯å¦æ­£å¸¸

åˆ›å»ºæ–‡ä»¶ `/var/www/html/index.php`

```php
<?php phpinfo(); ?>
```

------

## ä¸ƒã€Apacheè™šæ‹Ÿä¸»æœºé…ç½®

### ç¤ºä¾‹é…ç½®æ–‡ä»¶ï¼ˆæ·»åŠ åˆ° `/etc/httpd/conf/httpd.conf` æˆ–å•ç‹¬vhostæ–‡ä»¶ï¼‰

```apache
<VirtualHost *:80>
    ServerName farm.test
    DocumentRoot "/var/www/farm"

    <Directory "/var/www/farm">
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
</VirtualHost>
```

- æœ¬åœ°æ·»åŠ  hosts è§£æï¼š

```bash
echo "127.0.0.1 farm.test" >> /etc/hosts
```

------

## å…«ã€æ–‡ä»¶æƒé™é…ç½®

```bash
# è®¾ç½®Apacheä¸ºuploadç›®å½•çš„æ‰€æœ‰è€…
chown -R apache /var/www/farm/upload
```

------

